# On predicting heterogeneity in nanoparticle dosage
## Code repository

*This is the work of Celia V. Dowling under the supervision of DECRA Research Fellow Dr Stuart Johnston in the School of Mathematics and Statistics at the University of Melbourne, Australia.*

This repository contains code necessary to generate the analyses and figures associated with the manuscript **On predicting heterogeneity in nanoparticle dosage** (currently in submission). Manuscript authors: Celia V. Dowling, Paula M. Cevaal, Matthew Faria, and Stuart T. Johnston. Nanoparticles are a promising method for the targeted delivery of therapeutics, and thus modelling their interactions with cells has direct utility in industry research areas such as drug dosage and discovery and medical imaging. This manuscript seeks to address shortfalls in quantitative interpretations of nano-bio experimental data in order to assist future endeavours in this area. It employs an agent based model that incorporates cell movement and proliferation, cell-particle interactions and internalisation of particles.

The repository is organised as follows:
- **cells_simulation_runs_driver.m** This script produces (if not already in existence in the current working directory) a folder labelled by the date of creation within which is found a folder `Number_Runs{...}` (the name depends on the input parameters of the simulation) containing all of the output figures and other output files generated by the simulation. The user defines all experimental and relevant output parameters within this file.
- **cells_simulation** This function runs a single repetition of the simulation and is called within `cells_simulation_runs_driver.m`. If desired, a video and gif of the experimental domain can be produced for a single run.
- auxiliary scripts and functions on which the above code depends

The following main text figures are generated using the **cells_simulation_runs_driver.m** script:
- Figure 1: (m)-(r) Stored in `Fluor_dot_plots{X}hours.eps` with plots being produced at every X hour interval of experimental time.
- Figure 2: (a)-(b) Analytic standard deviation error bars can be added to `Analytic_distribs.eps` using the mean expected values of association at the relevant time points.
- Figure 3: (a)-(b) Multiple times series simulation data (`Analytic_distribs.eps`) can be plotted on the one axis by importing previous workspace variables from the `variables_{...}.mat` file (the name depends on the input parameters of the simulation).
- Figure 4: (a)-(x) Stored in `Dosage_distribs{X}hours.eps`.
- Figure 5: (g) The time series simulation data of all cells (`Analytic_distribs.eps`) can be superimposed onto the data categorised by number of cell divisions (`Time_series_split_by_{Y}divs.eps`) with Y being the maximum number of cell generations displayed. (h)-(y) Analytic (red line) Poisson density function can be superimposed on top of simulation dosage histograms (`Hist_split_{Y}divs{X}hours.eps`) using the mean expected values of association at the relevant time points.
- Figure 6: (a)-(f) Stored in `Dosage_distribs{X}hours.eps`. (g) Stored in `Analytic_distribs.eps`.
- Figure 7: (a)-(b) Stored in `Analytic_distribs.eps` (see Figure 2(a)-(b) note on error bars)
- Figure 8: (a)-(b) Stored in `Analytic_distribs.eps` and `Time_series_split_by_{Y}divs.eps` (see Figure 5(g) note on superposition). (c)-(z) Stored in `Hist_split_{Y}divs{X}hours.eps` (see Figure 5(h)-(y) note on analytic density).
- Figure 9: (a)-(f), (h)-(m) Stored in `Dosage_distribs{X}hours.eps`. (g), (n) Stored in `Analytic_distribs.eps`.
- Figure 10: Stored in `Analytic_distribs.eps` (see Figure 3(a)-(b) note on superposition).

The plots seen in Figure 1(g)-(l) are the work of Paula M. Cevaal, with details of the experiment being described in Appendix A.
